<%- include('./includes/head.ejs') %>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/check.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/forms.css">
</head>

<body>
    <%- include('./includes/navigation.ejs') %>

    <main>
        <div class="container">
            <div class="row">
                <div class=" col-md-12 col-lg-8 work-infor">   
                    <h2 style="text-align: center;">Work Time Information</h2>
                    <table  class=" table table-striped rollcall-table">
                        <thead>
                            <tr>
                                <th scope="col">Index</th>
                                <th scope="col">Work Date</th>
                                <th scope="col">Work Place</th>
                                <th scope="col">Check In Time </th>
                                <th scope="col">Check Out Time </th>
                                <th scope="col">Sesstion Duration</th>
                                <th scope="col">Total Work Time</th>
                                <th scope="col">Over Time</th>
                                <th scope="col">Annaul Leave</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% workInfors.forEach((workInfor,index) => { %>
                            <tr>
                                <td scope="col"><%= index +1 %></td>
                                <td scope="col"><%= workInfor.date %></td>
                                <td scope="col"><%= workInfor.workPlace %></td>
                                <td scope="col"><%= workInfor.checkIn %></td>
                                 <td scope="col">
                                    <% if(workInfor.checkOut !== null) { %>
                                       <%= workInfor.checkOut %>
                                    <% } else { %>
                                        --
                                    <% } %>
                                </td>
                                <td scope="col">
                                    <% if(workInfor.duration !== null) { %>
                                       <%= workInfor.duration %>
                                    <% } else { %>
                                        -
                                    <% } %>
                                </td>
                                <td scope="col">
                                    <% if(workInfor.workTimeAndaAnnualLeave !== null && !isNaN(workInfor.workTimeAndaAnnualLeave)) { %>
                                        <%= workInfor.workTimeAndaAnnualLeave %>
                                    <% } else if (isNaN(workInfor.workTimeAndaAnnualLeave)) { %>
                                        Not Finshed
                                    <% } else { %> 
                                        -
                                    <% } %>
                                </td>
                                 <td scope="col">
                                    <% if(workInfor.overTime !== null) { %>
                                        <%= workInfor.overTime %>
                                    <% } else { %>
                                        -
                                    <% } %>
                                </td>
                                <td scope="col"><%= workInfor.registedAnnualTime %></td>
                            </tr>
                            <% }); %> 
                        </tbody>
                    </table>
                    <%- include("./includes/pagination.ejs",
                        {   currentPage : currentPage,
                            nextPage : nextPage,
                            previousPage : previousPage,
                            lastPage : lastPage,
                            hasNextPage : hasNextPage,
                            hasPreviousPage : hasPreviousPage
                        }) 
                    %>
                </div>
                <div class="col-md-12 col-lg-4">
                    <div>
                        <h2 style="text-align: center; margin-bottom: 0!important;">Salary Query</h2>
                        <p style="text-align: center; margin-bottom: 0;"><i style="color:red;">(Only months you have worked can be choose)</i></p>
                       <form style="margin-top: 4px !important ;" class="  p-2 card form-profile salary-form" action="/salary-month" method="POST">
                           <div style="margin-top: 8px!important;" class="form-control">
                               <input  type="hidden" name="_csrf" value="<%= csrfToken %>" />
                               <label for="month">Choose Month : </label>
                               <Select name="chooseMonth" id="month">
                                   <% workMonths.forEach((month,index) => { %>
                                       <option <% if(index === 0){ %> selected <% } %>  value="<%= month %>"> <%= month %> </option>   
                                   <% }) %>                    
                               </Select>
                           </div>       
                           <button type="submit" class="btn btn-info">Query</button>
                       </form>
                    </div>
                    <div class="mt-3">
                        <h2 style="text-align: center; margin-bottom: 0!important;">Manager Information</h2>
                        <div >
                            <div style="margin-top: 8px !important ; text-align: start;" class="p-3 card form-profile salary-form">
                                <span style="margin-right: 2rem;">ID: </span>
                                <span><%=staff.managerID%></span>
                            </div>
                            <div style="margin-top: 8px !important ; text-align: start;" class="p-3 card form-profile salary-form">
                                <span style="margin-right: 2rem;">Name: </span>
                                <span><%=managerName%></span>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3">
                        <h2 style="text-align: center; margin-bottom: 0!important;">Display Option</h2>
                        <p style="text-align: center; margin-bottom: 0;"><i style="color:red;">(Choose Number Of WorkSession To Display)</i></p>
                        <form style="margin-top: 4px !important ;" class="  p-2 card form-profile salary-form" action="/work-infor/pagination" method="POST">
                           <div style="margin-top: 8px!important;" class="form-control">
                               <input  type="hidden" name="_csrf" value="<%= csrfToken %>" />
                               <label for="month">Number: </label>
                               <Select name="numberOfWorkSession" id="month">
                                   <% [5,10,20,30,40].forEach((number,index) => { %>
                                        <% if(prevChoose == number) { %>
                                       <option selected value="<%=number%>"> <%=number%> </option> 
                                        <% } else { %>
                                       <option  value="<%=number%>"> <%=number%> </option> 
                                        <% } %>
                                   <% }) %>                    
                               </Select>
                           </div>       
                           <button type="submit" class="btn btn-success">Query</button>
                       </form>
                    </div>
                </div>
            </div>
        </div>
    </main>
<%- include('./includes/end.ejs') %>